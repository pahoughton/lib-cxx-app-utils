#
# Makefile for Clue
#
#
# Created: 7/2/94
#
# $Id$
#
# (see end of file for Log info)

#
# Include standard MakeConfig configuration for GNU make required
#

include make.cfg

BETA_LIB_DEST	= /rating/dev/lib
# usr/local/lib/beta
BETA_INC_DEST	= /rating/dev/include
# /usr/local/include/beta

PROD_LIB_DEST	= /rating/dev/lib
PROD_INC_DEST	= /rating/dev/include


LIBRARY		= libClue.a

USER_INCS	= 	Avl.hh \
			Clue.hh \
			CdrBillNum.hh \
			DLList.h \
			DateRange.hh \
			DateRangeDaily.hh \
			DateRangeWeekly.hh \
			DateTime.hh \
			JumpTable.hh \
			Log.hh \
			Mapped.hh \
			MappedAvl.hh \
			Mcr.hh \
			Pix.h \
			SLList.h \
			Str.hh \
			TeleNum.h \
			TeleNum.hh \
			_G_config.h \
			builtin.h \
			gnubuiltin.h \
			gnustd.h \
			std.h \



PROTO_H		= _Clue_Proto.h

# **** S O U R C E   F I L E S ****

LIB_C_SOURCES   =   			\
    TeleNumFromString.c            \
    TeleNumToString.c              \


LIB_CXX_SOURCES = 			\
    CdrBillNum.C                   \
    DLList.C                       \
    DateRange.C                    \
    DateRangeDaily.C               \
    DateRangeWeekly.C              \
    DateTime.C                     \
    JumpTable.C                    \
    Log.C                          \
    Mapped.C                       \
    MappedAvl.C                    \
    Mcr.C                          \
    SLList.C                       \
    State.C                        \
    StateToStateCode.C             \
    TeleNum.C                      \
    error.C                        \



# *****  D E F I N E S  *****
#
# see MakeConfig(1) for portable library defines
#

DEFINES		=

# *****  I N C L U D E S *****
#
# see MakeConfig(1) for portable library includes
#


SRCINCDIR	= -I.
PRJINCDIR	= -I /rating/dev/include -I../../libCommon/src -I../../libmmalloc

INCDIRS		= $(SRCINCDIR)	\
		  $(PRJINCDIR)


# **** C O M P I L E / C P P ****

CPPOTHER 	=
CCDEBUG		= -Q -O2
CCOTHER		=


# ***** D E P E N D A N C I E S *****


all: $(PROTO_H) $(LIBRARY)

$(LIBRARY): $(LIB_OBJECTS) 
	$(UPDATELIB) $@ $?

depend:: 
	touch .depend
	$(MKPROTO) $(CPPFLAGS) $(LIB_C_SOURCES) >$(PROTO_H)
	$(DEPEND) -f.depend -- $(CPPFLAGS) -- $(LIB_SOURCES)
	sed  's/^\([^ 	].*o:.*\)$(PROTO_H)\(.*\)/\1\2/' .depend >dep.out
	mv dep.out .depend

depend::
	for i in $(SUBDIRS) ;\
	do \
	(cd $$i ; echo "--- Making" depend "in $$i ..."; \
	$(MAKE_COMMAND) depend TOPDIR='../$(TOPDIR)' TOP_PROTO_H=$(PROTO_H) ); \
	done

.depend: 
	touch .depend
	$(MKPROTO) $(CPPFLAGS) $(LIB_C_SOURCES) >$(PROTO_H)
	$(DEPEND) -f.depend -- $(CPPFLAGS) -- $(LIB_SOURCES)
	sed  's/^\([^ 	].*o:.*\)$(PROTO_H)\(.*\)/\1\2/' .depend >dep.out
	mv dep.out .depend
	for i in $(SUBDIRS) ;\
	do \
	(cd $$i ; echo "--- Making" depend "in $$i ..."; \
	$(MAKE_COMMAND) depend TOPDIR='../$(TOPDIR)' TOP_PROTO_H=$(PROTO_H) ); \
	done

clean:
	rm -f $(LIBRARY) $(LIB_OBJECTS) $(PROTO_H)




install:
	-( cd $(BETA_LIB_DEST); cp -f $(LIBRARY) old )
	-( cd $(BETA_INC_DEST); cp -f $(USER_INCS) old )
	cp -f $(LIBRARY) $(BETA_LIB_DEST)
	chmod 664 $(BETA_LIB_DEST)/$(LIBRARY)
	cp -f $(USER_INCS) $(BETA_INC_DEST)
	(cd $(BETA_INC_DEST); chmod 664 $(USER_INCS) )
	echo 'Beta Install Complete!'


install_production:
	-( cd $(PROD_LIB_DEST); cp -f $(LIBRARY) old )
	-( cd $(PROD_INC_DEST); cp -f $(USER_INCS) old )
	cp -f $(LIBRARY) $(PROD_LIB_DEST)
	chmod 664 $(PROD_LIB_DEST)/$(LIBRARY)
	cp -f $(USER_INCS) $(PROD_INC_DEST)
	(cd $(PROD_INC_DEST); chmod 664 $(USER_INCS) )
	echo 'Production Install Complete!'


proto: 
	$(MKPROTO) $(CPPFLAGS) $(LIB_C_SOURCES) >$(PROTO_H)

   
$(PROTO_H): $(LIB_C_SOURCES)
	$(MKPROTO) $(CPPFLAGS) $(LIB_C_SOURCES) >$@


tags: 
	etags -t *.h *.c *.C *.hh


FORCE:
#
# include dependancies generated by 'make depend'
#
include .depend

# 
# $Log$
# Revision 1.6  1995/01/13 20:27:48  ichudov
# Set the production destination
#
# Revision 1.5  1995/01/13  19:34:38  ichudov
# Corrected a bug in TeleNumCompare.
#
# Revision 1.4  1994/09/27  16:58:40  houghton
# Added RoundUp and some DateTime cleanup
#
# Revision 1.3  1994/08/16  20:50:17  houghton
# fixed datetime output if sec == 0
#
# Revision 1.2  1994/08/15  20:54:56  houghton
# Split Mapped out of mapped avl.
# Fixed a bunch of bugs.
# Fixed for ident of object modules.
# Prep for Rating QA Testing
#
# Revision 1.1  1994/01/23  18:16:55  houghton
# Production release 1.0 of MakeConfig system
#
#
